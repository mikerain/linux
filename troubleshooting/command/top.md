



top -o %CPU # Sort by CPU usage
top -o %MEM # Sort by memory usage



```
top - 02:01:42 up 1 min,  1 user,  load average: 0.15, 0.05, 0.02
Tasks: 130 total,   2 running, 128 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.2 us,  0.0 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.2 hi,  0.0 si,  0.0 st
MiB Mem :   1778.4 total,   1431.4 free,    144.8 used,    202.3 buff/cache
MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.   1465.6 avail Mem 

```



 **top å‘½ä»¤è¾“å‡º**ä¸­æ¯ä¸ªæŒ‡æ ‡çš„å«ä¹‰ï¼š

------

### ç¬¬ä¸€è¡Œï¼ˆç³»ç»Ÿè¿è¡Œæ—¶é—´å’Œè´Ÿè½½ï¼‰

```
top - 02:01:42 up 1 min,  1 user,  load average: 0.15, 0.05, 0.02
```

- **02:01:42** â†’ å½“å‰ç³»ç»Ÿæ—¶é—´
- **up 1 min** â†’ ç³»ç»Ÿå·²è¿è¡Œæ—¶é—´ï¼ˆè¿™é‡Œæ˜¯ 1 åˆ†é’Ÿï¼‰
- **1 user** â†’ å½“å‰æœ‰ 1 ä¸ªå·²ç™»å½•ç”¨æˆ·
- **load average: 0.15, 0.05, 0.02** â†’ ç³»ç»Ÿ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ã€‚
  - **è´Ÿè½½**æŒ‡æ­£åœ¨è¿è¡Œé˜Ÿåˆ—ï¼ˆCPU å¯æ‰§è¡Œè¿›ç¨‹ + ç­‰å¾… IO çš„è¿›ç¨‹ï¼‰çš„å¹³å‡æ•°é‡ã€‚
  - ä¸€èˆ¬ç»éªŒï¼šè´Ÿè½½æ•°å€¼ â‰ˆ CPU æ ¸å¿ƒæ•°æ—¶ï¼Œè¯´æ˜åˆšå¥½æ»¡è´Ÿè·ã€‚å¦‚æœ 1 æ ¸ CPU ä¸Š load > 1ï¼Œå°±æ„å‘³ç€æœ‰è¿›ç¨‹åœ¨æ’é˜Ÿç­‰å¾…ã€‚

------

### ç¬¬äºŒè¡Œï¼ˆä»»åŠ¡/è¿›ç¨‹çŠ¶æ€ï¼‰

```
Tasks: 130 total,   2 running, 128 sleeping,   0 stopped,   0 zombie
```

- **130 total** â†’ ç³»ç»Ÿä¸­å…±æœ‰ 130 ä¸ªè¿›ç¨‹
- **2 running** â†’ å½“å‰æ­£åœ¨è¿è¡Œï¼ˆå ç”¨ CPUï¼‰çš„è¿›ç¨‹æ•°
- **128 sleeping** â†’ å¤„äºä¼‘çœ ï¼ˆç­‰å¾…äº‹ä»¶æˆ– IOï¼‰çš„è¿›ç¨‹æ•°
- **0 stopped** â†’ è¢«æš‚åœçš„è¿›ç¨‹æ•°
- **0 zombie** â†’ åƒµå°¸è¿›ç¨‹ï¼ˆå·²é€€å‡ºä½†çˆ¶è¿›ç¨‹æœªå›æ”¶èµ„æºï¼‰çš„æ•°é‡

------

### ç¬¬ä¸‰è¡Œï¼ˆCPU ä½¿ç”¨ç‡ï¼‰

```
%Cpu(s):  0.2 us,  0.0 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.2 hi,  0.0 si,  0.0 st
```

å„å­—æ®µå«ä¹‰ï¼š

- **us (user)** 0.2% â†’ ç”¨æˆ·ç©ºé—´å ç”¨ CPU æ—¶é—´ï¼ˆåº”ç”¨ç¨‹åºè¿è¡Œæ¶ˆè€—ï¼‰
- **sy (system)** 0.0% â†’ å†…æ ¸ç©ºé—´å ç”¨ CPU æ—¶é—´ï¼ˆç³»ç»Ÿè°ƒç”¨ã€å†…æ ¸è¿›ç¨‹ï¼‰
- **ni (nice)** 0.0% â†’ è°ƒæ•´è¿‡ nice ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨ CPU æ—¶é—´
- **id (idle)** 99.7% â†’ ç©ºé—² CPU æ—¶é—´
- **wa (iowait)** 0.0% â†’ ç­‰å¾… IO å®Œæˆçš„ CPU æ—¶é—´
- **hi (hardware irq)** 0.2% â†’ ç¡¬ä»¶ä¸­æ–­å ç”¨æ—¶é—´
- **si (software irq)** 0.0% â†’ è½¯ä»¶ä¸­æ–­å ç”¨æ—¶é—´
- **st (steal)** 0.0% â†’ è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œè¢« hypervisor â€œå·èµ°â€çš„ CPU æ—¶é—´

ğŸ‘‰ æœ¬ä¾‹ä¸­ CPU å‡ ä¹æ˜¯ç©ºé—²çŠ¶æ€ï¼ˆ99.7% ç©ºé—²ï¼‰ã€‚

------

### ç¬¬å››è¡Œï¼ˆå†…å­˜ä½¿ç”¨æƒ…å†µï¼‰

```
MiB Mem :   1778.4 total,   1431.4 free,    144.8 used,    202.3 buff/cache
```

- **total 1778.4 MiB** â†’ ç‰©ç†å†…å­˜æ€»é‡
- **free 1431.4 MiB** â†’ å½“å‰å®Œå…¨ç©ºé—²çš„å†…å­˜
- **used 144.8 MiB** â†’ æ­£åœ¨ä½¿ç”¨çš„å†…å­˜
- **buff/cache 202.3 MiB** â†’ è¢« Linux ç”¨ä½œç¼“å­˜ï¼ˆbuffer + page cacheï¼‰çš„å†…å­˜ï¼Œå¯éšæ—¶å›æ”¶

âš ï¸ æ³¨æ„ï¼šLinux æŠŠå¤§é‡å†…å­˜ç”¨äºç¼“å­˜æ–‡ä»¶ IOï¼Œè¿™éƒ¨åˆ†è™½ç„¶æ˜¾ç¤ºâ€œå·²ç”¨â€ï¼Œä½†å…¶å®å¯ä»¥å¿«é€Ÿé‡Šæ”¾ã€‚

------

### ç¬¬äº”è¡Œï¼ˆSwap ä½¿ç”¨æƒ…å†µï¼‰

```
MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.   1465.6 avail Mem
```

- **total 2048.0 MiB** â†’ äº¤æ¢åˆ†åŒºæ€»å¤§å°
- **free 2048.0 MiB** â†’ ç©ºé—² swap
- **used 0.0 MiB** â†’ å·²ä½¿ç”¨ swapï¼ˆè¿™é‡Œæ²¡æœ‰ç”¨åˆ° swapï¼‰
- **avail Mem 1465.6 MiB** â†’ åœ¨ä¸ä½¿ç”¨ swap çš„æƒ…å†µä¸‹ï¼Œå¯ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨çš„å†…å­˜ï¼ˆfree + å¯å›æ”¶çš„ç¼“å­˜ï¼‰





çœ‹ä¸€ä¸‹cpu sysè¾ƒé«˜çš„ä¾‹å­ï¼š

cpu : sys: 76.9 sy

```
top - 02:34:02 up 33 min,  1 user,  load average: 4.50, 1.85, 0.70
Tasks: 124 total,   4 running, 120 sleeping,   0 stopped,   0 zombie
%Cpu(s):  3.8 us, 76.9 sy,  0.0 ni,  0.7 id,  0.0 wa,  0.7 hi, 18.0 si,  0.0 st
MiB Mem :   1778.4 total,   1010.4 free,    156.0 used,    612.1 buff/cache
MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.   1450.8 avail Mem 

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND  
   4813 root      20   0   64344    452      0 S  50.3   0.0   1:03.43 stress-+ 
   4812 root      20   0   64344    452      0 R  49.3   0.0   1:03.30 stress-+ 
   4815 root      20   0   64340   2488      0 R  31.1   0.1   0:41.13 stress-+ 
   4814 root      20   0   64340   2488      0 S  30.5   0.1   0:41.16 stress-+
```



cpu:  sy 95-96, system: cs 6197 éƒ½é«˜ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢é«˜

```
vmstat  1  5
procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
 r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
 4  0      0 1036028   3144 623672    0    0    97    43  482  921  1 13 86  0  0
 7  0      0 1035316   3144 623672    0    0     0     0 2293 6197  3 96  1  0  0
 5  0      0 1035252   3144 623672    0    0     0     0 2185 6112  4 95  0  0  0


```



å®šä½é—®é¢˜ï¼š

 æŸ¥çœ‹è¿›ç¨‹ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢cswch

```
[root@localhost tmp]# pidstat -wt -p 4815 1
Linux 4.18.0-553.el8_10.x86_64 (localhost.localdomain) 	08/27/2025 	_x86_64_	(2 CPU)

02:38:44 AM   UID      TGID       TID   cswch/s nvcswch/s  Command
02:38:45 AM     0      4815         -   1413.00     10.00  stress-ng-sock
02:38:45 AM     0         -      4815   1413.00     10.00  |__stress-ng-sock

02:38:45 AM   UID      TGID       TID   cswch/s nvcswch/s  Command
02:38:46 AM     0      4815         -   2883.00     13.00  stress-ng-sock
02:38:46 AM     0         -      4815   2883.00     13.00  |__stress-ng-sock
```

æŸ¥å†…æ ¸å‡½æ•°çƒ­ç‚¹

ç”¨ perf æ˜¯æœ€ç›´æ¥çš„ï¼š

```

perf top -p 4815

Samples: 9K of event 'cycles', 4000 Hz, Event count (approx.): 2352848382 lost: 
Overhead  Shared Object     Symbol                                              
  24.12%  [kernel]          [k] copy_user_enhanced_fast_string                  
   3.34%  [kernel]          [k] __raw_callee_save___pv_queued_spin_unlock       
   3.24%  [kernel]          [k] entry_SYSCALL_64                                
   3.14%  [kernel]          [k] pvclock_clocksource_
```



ç”¨ `strace` æŠ“çº¿ç¨‹ï¼š

- `-c` è¡¨ç¤ºç»Ÿè®¡å„ç±»ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°å’Œè€—æ—¶ã€‚
- å¦‚æœå‘ç°æŸç±» syscallï¼ˆå¦‚ `futex`, `epoll_wait`, `sendto`ï¼‰è°ƒç”¨é‡å¼‚å¸¸å¤§ï¼Œå°±è¯´æ˜é—®é¢˜å‡ºåœ¨è¿™é‡Œã€‚

```
strace -fp 4815  -c
strace: Process 5177 attached


ç­‰1åˆ†é’Ÿï¼Œ^ï½ƒç»“æŸï¼Œä¼šå‡ºä»¥ä¸‹ç»“æœï¼š


strace: Process 5177 detached
% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
 96.90    5.520663           1   2882921           sendto
  0.97    0.055048           1     45128      5641 ioctl
  0.62    0.035409           2     16923           close
  0.34    0.019339           3      5641           openat
  0.32    0.018021           1     16923           getsockname
  0.22    0.012418           2      5641           read
  0.21    0.011816           1      8448      5641 accept4
  0.11    0.006386           1      5641           getpeername
  0.11    0.006117           2      2834           accept
  0.11    0.006008           1      5641           getsockopt
  0.11    0.005998           1      5641           setsockopt
------ ----------- ----------- --------- --------- ----------------
100.00    5.697223           1   3001382     11282 total

```



**sys é«˜ â†’ ç¨‹åºå¤§é‡æ¶ˆè€— CPU åœ¨å†…æ ¸æ€**ï¼Œé€šå¸¸æ˜¯ I/Oã€é”ã€ç³»ç»Ÿè°ƒç”¨é£æš´ã€‚

**æ’æŸ¥æ€è·¯**ï¼š

1. `pidstat/top -H` â†’ ç¡®è®¤æ˜¯å“ªä¸ªçº¿ç¨‹ã€‚
2. `strace -c -p <pid>` â†’ çœ‹ç³»ç»Ÿè°ƒç”¨ç±»å‹ã€‚
3. `perf top -p <pid>` â†’ çœ‹å†…æ ¸å‡½æ•°çƒ­ç‚¹ã€‚
4. æ ¹æ®ç»“æœåˆ¤æ–­æ˜¯ç½‘ç»œã€ç£ç›˜è¿˜æ˜¯çº¿ç¨‹è°ƒåº¦é—®é¢˜ã€‚