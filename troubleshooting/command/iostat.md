**`iostat`** çš„ç”¨æ³•å’Œå¸¸è§å‚æ•°ç¤ºä¾‹ï¼ˆRHEL 8 ä¸­ä¸€èˆ¬åœ¨ `sysstat` åŒ…é‡Œï¼‰ï¼š

------

## 1. å®‰è£…

åœ¨ RHEL 8 ä¸Šï¼Œ`iostat` å±äº `sysstat` å·¥å…·é›†ï¼š

```
sudo dnf install -y sysstat
```

------

## 2. åŸºæœ¬ç”¨æ³•

`iostat` å¯ä»¥æ˜¾ç¤º CPU ä½¿ç”¨ç‡å’Œç£ç›˜ I/O ç»Ÿè®¡ä¿¡æ¯ã€‚
 å‘½ä»¤æ ¼å¼ï¼š

```
iostat [å‚æ•°] [é—´éš”ç§’æ•°] [é‡å¤æ¬¡æ•°]
```

ä¾‹å¦‚ï¼š

```
iostat 2 5
```

ğŸ‘‰ æ¯éš” 2 ç§’è¾“å‡ºä¸€æ¬¡ï¼Œæ€»å…±è¾“å‡º 5 æ¬¡ã€‚

------

## 3. å¸¸è§å‚æ•°

### (1) **-x** ï¼šæ‰©å±•ç»Ÿè®¡ï¼ˆæ¨èï¼‰

```
iostat -x 2 5
```

æ˜¾ç¤ºæ›´è¯¦ç»†çš„ç£ç›˜ I/O ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š

- `r/s, w/s`ï¼šæ¯ç§’è¯»å†™æ¬¡æ•°
- `rkB/s, wkB/s`ï¼šæ¯ç§’è¯»å†™ KB
- `await`ï¼šå¹³å‡ I/O ç­‰å¾…æ—¶é—´ï¼ˆmsï¼Œè¶Šé«˜è¯´æ˜ç£ç›˜æ€§èƒ½ç“¶é¢ˆï¼‰
- `%util`ï¼šç£ç›˜ä½¿ç”¨ç‡ï¼ˆæ¥è¿‘ 100% è¯´æ˜ç£ç›˜å¿™ä¸è¿‡æ¥ï¼‰

------

### (2) **-d** ï¼šåªæ˜¾ç¤ºç£ç›˜ I/O

```
iostat -d 2 5
```

åªæ˜¾ç¤ºç£ç›˜è¯»å†™æƒ…å†µï¼Œä¸æ˜¾ç¤º CPUã€‚

------

### (3) **-c** ï¼šåªæ˜¾ç¤º CPU

```
iostat -c 1 3
```

åªæ˜¾ç¤º CPU ä½¿ç”¨ç‡ã€‚

------

### (4) **-m** ï¼šä»¥ MB ä¸ºå•ä½æ˜¾ç¤º

```
iostat -dxm 2 5
```

ä»¥ MB/s ä¸ºå•ä½ï¼Œæ‰©å±•ä¿¡æ¯ã€‚

------

### (5) **-p** ï¼šæŒ‡å®šè®¾å¤‡/åˆ†åŒº

```
iostat -p sda 2 5
```

åªæŸ¥çœ‹ `sda` ç£ç›˜çš„æ€§èƒ½ã€‚

------

## 4. è¾“å‡ºè§£é‡Šï¼ˆå¸¸è§æŒ‡æ ‡ï¼‰

ä»¥ `iostat -x` ä¸ºä¾‹ï¼š

```
Device:   r/s   w/s rkB/s wkB/s avgrq-sz avgqu-sz await svctm %util
sda       5.0   2.0  40.0  10.0    20.0     0.1   5.2   0.4   35.0
```

- **r/s, w/s** ï¼šæ¯ç§’è¯»å†™è¯·æ±‚æ•°
- **rkB/s, wkB/s** ï¼šè¯»å†™ååé‡ï¼ˆKB/s æˆ– MB/sï¼‰
- **avgrq-sz** ï¼šå¹³å‡æ¯æ¬¡ I/O è¯·æ±‚å¤§å°ï¼ˆæ‰‡åŒºæ•°ï¼‰
- **avgqu-sz** ï¼šå¹³å‡é˜Ÿåˆ—é•¿åº¦ï¼ˆæ’é˜Ÿçš„ I/O æ•°é‡ï¼‰
- **await** ï¼šå¹³å‡ I/O ç­‰å¾…æ—¶é—´ï¼ˆmsï¼Œ>50ms è¯´æ˜å¯èƒ½æœ‰ç“¶é¢ˆï¼‰
- **%util** ï¼šç£ç›˜åˆ©ç”¨ç‡ï¼Œæ¥è¿‘ 100% æ—¶è¯´æ˜ç£ç›˜ç¹å¿™

------

## 5. ç¤ºä¾‹åœºæ™¯

- **å®šä½ç£ç›˜ç“¶é¢ˆ**ï¼š

```
iostat -x 1 10
```

çœ‹ `%util` å’Œ `await` æ˜¯å¦è¿‡é«˜ã€‚

- **è§‚å¯Ÿç‰¹å®šç£ç›˜ååé‡**ï¼š

```
iostat -p sdb -mx 2 5
```





```
iostat -x 1
Linux 4.18.0-553.el8_10.x86_64 (localhost.localdomain) 	08/25/2025 	_x86_64_	(2 CPU)

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           3.27    0.03    0.17    0.01    0.01   96.50

Device            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util
vda              0.03    0.41      3.02    396.81     0.00     0.00   0.24   0.94    0.34   11.66   0.00   102.98   966.90   0.60   0.03
vdb              0.00    0.00      0.02      0.00     0.00     0.00   0.00   0.00    0.04    0.00   0.00    21.65     0.00   0.12   0.00
scd0             0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.04    0.00   0.00     3.14     0.00   0.29   0.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          47.76    0.00   26.87    0.50    1.00   23.88

Device            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util
vda              0.99  836.63      7.92 833293.56     0.00     2.97   0.00   0.35    0.00   38.48  32.19     8.00   996.01   0.87  73.07
vdb              0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.00    0.00   0.00     0.00     0.00   0.00   0.00
scd0             0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.00    0.00   0.00     0.00     0.00   0.00   0.00

avg-cpu:  %user   %nice %system %iowait  %steal   %idle
          52.26    0.00   37.19    0.00    1.01    9.55

Device            r/s     w/s     rkB/s     wkB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util
vda              0.00 1167.00      0.00 1163077.00     0.00     1.00   0.00   0.09    0.00   11.65  13.59     0.00   996.64   0.30  34.80
vdb              0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.00    0.00   0.00     0.00     0.00   0.00   0.00
scd0             0.00    0.00      0.00      0.00     0.00     0.00   0.00   0.00    0.00    0.00   0.00     0.00     0.00   0.00   0.00


```



## 1ï¸âƒ£ iostat -x 1 è¾“å‡ºåˆ†æ

### ç¬¬ä¸€æ®µï¼ˆç©ºé—²çŠ¶æ€ï¼‰

```
avg-cpu:  %user 3.27  %system 0.17  %iowait 0.01  %idle 96.50
vda: w/s=0.41, wkB/s=396.81, svctm=0.60, %util=0.03
```

- CPU ç©ºé—² (`id=96.5%`)ï¼Œç£ç›˜å‡ ä¹æ²¡å‹åŠ› (`%util=0.03`)ã€‚
- å†™å…¥é€Ÿåº¦æä½ (~396KB/s)ï¼ŒI/O è¯·æ±‚å“åº”æ—¶é—´å¾ˆçŸ­ (`svctm=0.6ms`)ã€‚
- æ­¤æ—¶ç³»ç»Ÿè¿˜æœªè¿›è¡Œç£ç›˜å‹æµ‹ã€‚

------

### ç¬¬äºŒæ®µï¼ˆå‹åŠ›ä¸­ï¼‰

```
avg-cpu: %user=47.76, %system=26.87, %iowait=0.50
vda: w/s=836.63, wkB/s=833293.56 KB/s, svctm=0.87ms, %util=73.07
```

- CPU å ç”¨å¢åŠ ï¼Œç³»ç»Ÿæ€ï¼ˆ`sy=26.87%`ï¼‰ä¹Ÿæ˜¾è‘—ä¸Šå‡ â†’ è¡¨æ˜ç£ç›˜ I/O æ¶ˆè€—äº† CPUã€‚
- å†™é€Ÿç‡éå¸¸é«˜ï¼šçº¦ **833 MB/s**ã€‚
- `%util=73%` â†’ vda è®¾å¤‡çº¦ 3/4 æ—¶é—´è¢«å¿™ç¢Œå ç”¨ï¼Œè¯´æ˜ I/O è´Ÿè½½é«˜ã€‚
- `w_await=38.48ms` â†’ ç£ç›˜è¯·æ±‚å¹³å‡ç­‰å¾…æ—¶é—´ ~38msï¼Œè¯´æ˜ç£ç›˜å¼€å§‹æ’é˜Ÿï¼Œä½†è¿˜åœ¨å¯æ¥å—èŒƒå›´ã€‚
- `rkB/s` å¾ˆå° â†’ å‹æµ‹ä¸»è¦æ˜¯å†™æ“ä½œã€‚

------

### ç¬¬ä¸‰æ®µï¼ˆå‹åŠ›é«˜å³°ï¼‰

```
avg-cpu: %user=52.26, %system=37.19, %iowait=0
vda: w/s=1167, wkB/s=1163077 KB/s, svctm=0.30ms, %util=34.8
```

- å†™é€Ÿç‡è¿›ä¸€æ­¥å‡é«˜ (~1.1GB/s)ï¼ŒCPU æ¶ˆè€—å¢åŠ ã€‚
- `%util=34.8%` æœ‰ç‚¹ä½ï¼Œå¯èƒ½æ˜¯å› ä¸º I/O è¢«ç¼“å­˜æˆ–æ‰¹é‡å†™æ“ä½œã€‚
- `w_await=11.65ms` â†’ å¹³å‡ç­‰å¾…æ—¶é—´ä¸‹é™ï¼Œå¯èƒ½æ•°æ®å†™å…¥è¢«ä¼˜åŒ–æˆ–ä½¿ç”¨äº†ç¼“å­˜ã€‚



```
    vmstat 1
    procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
     r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
     1  0      0 543940   3084 1118932    0    0     9  1782   81   57  3  0 96  0  0
     1  0      0 727704   3084 935200    0    0     0 626312 1492  288 33 19 37 10  1
     2  0      0 965640   3084 697324    0    0     0 911820 2109  255 49 30 21  1  0
     1  0      0 553768   3084 1109108    0    0     0 757816 1595  241 38 20 32 11  1
     1  0      0 807080   3084 855860    0    0     0 945225 2181  276 49 32 18  0  0
     1  0      0 568120   3084 1094756    0    0     0 856708 1370  240 28 15 32 25  1
     1  0      0 1052908   3084 610040    0    0     0 856520 2043  296 41 30 28  0  1
```

